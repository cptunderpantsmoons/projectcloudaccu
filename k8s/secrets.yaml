apiVersion: v1
kind: Secret
metadata:
  name: database-secret
  namespace: accu-platform
type: Opaque
stringData:
  url: "postgresql://accu_user:${POSTGRES_PASSWORD}@postgres-service:5432/accu_platform"
  username: "accu_user"
  password: "${POSTGRES_PASSWORD}"
---
apiVersion: v1
kind: Secret
metadata:
  name: auth-secrets
  namespace: accu-platform
type: Opaque
stringData:
  jwt-secret: "${JWT_SECRET}"
  jwt-refresh-secret: "${JWT_REFRESH_SECRET}"
  bcrypt-salt-rounds: "10"
---
apiVersion: v1
kind: Secret
metadata:
  name: email-secrets
  namespace: accu-platform
type: Opaque
stringData:
  service: "${EMAIL_SERVICE}"
  user: "${EMAIL_USER}"
  password: "${EMAIL_PASSWORD}"
---
apiVersion: v1
kind: Secret
metadata:
  name: storage-secrets
  namespace: accu-platform
type: Opaque
stringData:
  aws-access-key-id: "${AWS_ACCESS_KEY_ID}"
  aws-secret-access-key: "${AWS_SECRET_ACCESS_KEY}"
  bucket: "${AWS_S3_BUCKET}"
---
apiVersion: v1
kind: Secret
metadata:
  name: cer-secrets
  namespace: accu-platform
type: Opaque
stringData:
  api-url: "${CER_API_URL}"
  api-key: "${CER_API_KEY}"
---
apiVersion: v1
kind: Secret
metadata:
  name: monitoring-secrets
  namespace: accu-platform
type: Opaque
stringData:
  grafana-admin-password: "${GRAFANA_PASSWORD}"
  elasticsearch-password: "${ELASTICSEARCH_PASSWORD}"
---
apiVersion: v1
kind: Secret
metadata:
  name: webhook-secrets
  namespace: accu-platform
type: Opaque
stringData:
  slack-webhook-url: "${SLACK_WEBHOOK_URL}"
  discord-webhook-url: "${DISCORD_WEBHOOK_URL}"
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: accu-platform-sa
  namespace: accu-platform
automountServiceAccountToken: true
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: accu-platform-role
rules:
- apiGroups: [""]
  resources: ["configmaps", "secrets", "services", "endpoints"]
  verbs: ["get", "list", "watch"]
- apiGroups: ["apps"]
  resources: ["deployments", "replicasets"]
  verbs: ["get", "list", "watch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: accu-platform-binding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: accu-platform-role
subjects:
- kind: ServiceAccount
  name: accu-platform-sa
  namespace: accu-platform